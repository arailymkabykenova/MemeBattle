<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket –∏ –ò–≥—Ä–æ–≤—ã—Ö –≠–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border: 1px solid #e9ecef;
        }

        .section h2 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #4facfe;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: transform 0.2s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffd43b 0%, #fcc419 100%);
            color: #495057;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 600;
        }

        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .log {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin-top: 20px;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 4px;
        }

        .log-entry.sent {
            background: #2a4365;
            color: #90cdf4;
        }

        .log-entry.received {
            background: #22543d;
            color: #9ae6b4;
        }

        .log-entry.error {
            background: #742a2a;
            color: #feb2b2;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 600;
        }

        .tab.active {
            border-bottom-color: #4facfe;
            color: #4facfe;
        }

        .tab:hover {
            background: #f8f9fa;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéÆ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket –∏ –ò–≥—Ä–æ–≤—ã—Ö –≠–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤</h1>
            <p>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –º–µ–º-–∫–∞—Ä—Ç–æ—á–Ω–æ–π –∏–≥—Ä—ã</p>
        </div>

        <div class="content">
            <!-- WebSocket –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
            <div class="section">
                <h2>üîå WebSocket –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
                
                <div class="form-group">
                    <label for="wsToken">JWT –¢–æ–∫–µ–Ω:</label>
                    <input type="text" id="wsToken" placeholder="–í–≤–µ–¥–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏">
                </div>

                <div class="form-group">
                    <label for="wsRoomId">ID –ö–æ–º–Ω–∞—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                    <input type="number" id="wsRoomId" placeholder="ID –∫–æ–º–Ω–∞—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è">
                </div>

                <div class="status" id="wsStatus">
                    <strong>–°—Ç–∞—Ç—É—Å:</strong> –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
                </div>

                <button class="btn" onclick="connectWebSocket()">üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</button>
                <button class="btn btn-danger" onclick="disconnectWebSocket()">‚ùå –û—Ç–∫–ª—é—á–∏—Ç—å—Å—è</button>

                <div class="tabs">
                    <div class="tab active" onclick="switchTab('room')">–ö–æ–º–Ω–∞—Ç—ã</div>
                    <div class="tab" onclick="switchTab('game')">–ò–≥—Ä–∞</div>
                    <div class="tab" onclick="switchTab('actions')">–î–µ–π—Å—Ç–≤–∏—è</div>
                </div>

                <!-- –ö–æ–º–Ω–∞—Ç—ã -->
                <div class="tab-content active" id="room-tab">
                    <div class="grid-2">
                        <div>
                            <h3>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ</h3>
                            <div class="form-group">
                                <label for="joinRoomId">ID –ö–æ–º–Ω–∞—Ç—ã:</label>
                                <input type="number" id="joinRoomId" placeholder="ID –∫–æ–º–Ω–∞—Ç—ã">
                            </div>
                            <button class="btn" onclick="joinRoom()">‚ûï –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ ID</button>
                        </div>
                        <div>
                            <h3>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –∫–æ–¥—É</h3>
                            <div class="form-group">
                                <label for="joinRoomCode">–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã:</label>
                                <input type="text" id="joinRoomCode" placeholder="–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã">
                            </div>
                            <button class="btn" onclick="joinRoomByCode()">üîë –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ –∫–æ–¥—É</button>
                        </div>
                    </div>
                    <div class="full-width">
                        <button class="btn btn-warning" onclick="leaveRoom()">üö™ –ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                        <button class="btn btn-success" onclick="startGame()">üéÆ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    </div>
                </div>

                <!-- –ò–≥—Ä–∞ -->
                <div class="tab-content" id="game-tab">
                    <div class="grid-2">
                        <div>
                            <h3>–†–∞—É–Ω–¥—ã</h3>
                            <div class="form-group">
                                <label for="situationText">–¢–µ–∫—Å—Ç —Å–∏—Ç—É–∞—Ü–∏–∏:</label>
                                <textarea id="situationText" rows="3" placeholder="–¢–µ–∫—Å—Ç —Å–∏—Ç—É–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏"></textarea>
                            </div>
                            <button class="btn" onclick="startRound()">üéØ –ù–∞—á–∞—Ç—å —Ä–∞—É–Ω–¥</button>
                        </div>
                        <div>
                            <h3>–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã</h3>
                            <div class="form-group">
                                <label for="gameId">ID –ò–≥—Ä—ã:</label>
                                <input type="number" id="gameId" placeholder="ID –∏–≥—Ä—ã">
                            </div>
                            <button class="btn" onclick="getGameState()">üìä –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</button>
                        </div>
                    </div>
                </div>

                <!-- –î–µ–π—Å—Ç–≤–∏—è -->
                <div class="tab-content" id="actions-tab">
                    <div class="grid-2">
                        <div>
                            <h3>–í—ã–±–æ—Ä –∫–∞—Ä—Ç—ã</h3>
                            <div class="form-group">
                                <label for="roundId">ID –†–∞—É–Ω–¥–∞:</label>
                                <input type="number" id="roundId" placeholder="ID —Ä–∞—É–Ω–¥–∞">
                            </div>
                            <div class="form-group">
                                <label for="cardType">–¢–∏–ø –∫–∞—Ä—Ç—ã:</label>
                                <select id="cardType">
                                    <option value="starter">Starter</option>
                                    <option value="standard">Standard</option>
                                    <option value="unique">Unique</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="cardNumber">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã:</label>
                                <input type="number" id="cardNumber" placeholder="–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã">
                            </div>
                            <button class="btn" onclick="submitCardChoice()">üé¥ –í—ã–±—Ä–∞—Ç—å –∫–∞—Ä—Ç—É</button>
                        </div>
                        <div>
                            <h3>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</h3>
                            <div class="form-group">
                                <label for="voteRoundId">ID –†–∞—É–Ω–¥–∞:</label>
                                <input type="number" id="voteRoundId" placeholder="ID —Ä–∞—É–Ω–¥–∞">
                            </div>
                            <div class="form-group">
                                <label for="voteCardId">ID –ö–∞—Ä—Ç—ã:</label>
                                <input type="number" id="voteCardId" placeholder="ID –∫–∞—Ä—Ç—ã –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è">
                            </div>
                            <button class="btn" onclick="submitVote()">üó≥Ô∏è –ì–æ–ª–æ—Å–æ–≤–∞—Ç—å</button>
                        </div>
                    </div>
                    <div class="full-width">
                        <button class="btn" onclick="ping()">üèì Ping</button>
                        <button class="btn" onclick="getRoundCards()">üìã –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç—ã —Ä–∞—É–Ω–¥–∞</button>
                        <button class="btn" onclick="getChoicesForVoting()">üë• –ü–æ–ª—É—á–∏—Ç—å –≤—ã–±–æ—Ä—ã –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</button>
                    </div>
                </div>

                <div class="log" id="wsLog">
                    <div class="log-entry info">WebSocket –ª–æ–≥ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ...</div>
                </div>
            </div>

            <!-- HTTP API –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
            <div class="section">
                <h2>üåê HTTP API –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
                
                <div class="form-group">
                    <label for="httpToken">JWT –¢–æ–∫–µ–Ω:</label>
                    <input type="text" id="httpToken" placeholder="–í–≤–µ–¥–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤">
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="switchHttpTab('rooms')">–ö–æ–º–Ω–∞—Ç—ã</div>
                    <div class="tab" onclick="switchHttpTab('games')">–ò–≥—Ä—ã</div>
                    <div class="tab" onclick="switchHttpTab('cards')">–ö–∞—Ä—Ç—ã</div>
                </div>

                <!-- –ö–æ–º–Ω–∞—Ç—ã API -->
                <div class="tab-content active" id="rooms-tab">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏</h3>
                    <div class="form-group">
                        <label for="roomMaxPlayers">–ú–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤:</label>
                        <input type="number" id="roomMaxPlayers" value="4" min="2" max="8">
                    </div>
                    <div class="form-group">
                        <label for="roomIsPublic">–ü—É–±–ª–∏—á–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞:</label>
                        <select id="roomIsPublic">
                            <option value="true">–î–∞</option>
                            <option value="false">–ù–µ—Ç</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="roomAgeGroup">–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞:</label>
                        <select id="roomAgeGroup">
                            <option value="teen">–ü–æ–¥—Ä–æ—Å—Ç–∫–∏ (13-17)</option>
                            <option value="adult">–í–∑—Ä–æ—Å–ª—ã–µ (18+)</option>
                        </select>
                    </div>
                    <button class="btn" onclick="createRoom()">üè† –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                    <button class="btn" onclick="getPublicRooms()">üìã –ü—É–±–ª–∏—á–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã</button>
                    <button class="btn" onclick="getMyRooms()">üë§ –ú–æ–∏ –∫–æ–º–Ω–∞—Ç—ã</button>
                </div>

                <!-- –ò–≥—Ä—ã API -->
                <div class="tab-content" id="games-tab">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–∞–º–∏</h3>
                    <div class="form-group">
                        <label for="httpGameId">ID –ò–≥—Ä—ã:</label>
                        <input type="number" id="httpGameId" placeholder="ID –∏–≥—Ä—ã">
                    </div>
                    <div class="form-group">
                        <label for="httpRoomId">ID –ö–æ–º–Ω–∞—Ç—ã:</label>
                        <input type="number" id="httpRoomId" placeholder="ID –∫–æ–º–Ω–∞—Ç—ã">
                    </div>
                    <button class="btn" onclick="getGame()">üìä –ü–æ–ª—É—á–∏—Ç—å –∏–≥—Ä—É</button>
                    <button class="btn" onclick="getCurrentGame()">üéÆ –¢–µ–∫—É—â–∞—è –∏–≥—Ä–∞ –≤ –∫–æ–º–Ω–∞—Ç–µ</button>
                    <button class="btn" onclick="getMyCards()">üé¥ –ú–æ–∏ –∫–∞—Ä—Ç—ã –¥–ª—è –∏–≥—Ä—ã</button>
                    <button class="btn" onclick="generateSituation()">üé≠ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é</button>
                </div>

                <!-- –ö–∞—Ä—Ç—ã API -->
                <div class="tab-content" id="cards-tab">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∞–º–∏</h3>
                    <div class="form-group">
                        <label for="cardsCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç:</label>
                        <input type="number" id="cardsCount" value="3" min="1" max="10">
                    </div>
                    <button class="btn" onclick="getUserCards()">üìö –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                    <button class="btn" onclick="getStarterCards()">üåü –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã</button>
                    <button class="btn" onclick="getUniqueCards()">üíé –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã</button>
                </div>

                <div class="log" id="httpLog">
                    <div class="log-entry info">HTTP API –ª–æ–≥ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let ws = null;
        let isConnected = false;
        const API_BASE = 'http://localhost:8000';

        // WebSocket —Ñ—É–Ω–∫—Ü–∏–∏
        function connectWebSocket() {
            const token = document.getElementById('wsToken').value;
            const roomId = document.getElementById('wsRoomId').value;
            
            if (!token) {
                log('error', '–í–≤–µ–¥–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
                return;
            }

            const url = `${API_BASE.replace('http', 'ws')}/ws?token=${token}${roomId ? `&room_id=${roomId}` : ''}`;
            
            try {
                ws = new WebSocket(url);
                
                ws.onopen = function() {
                    isConnected = true;
                    updateWebSocketStatus('–ü–æ–¥–∫–ª—é—á–µ–Ω', 'connected');
                    log('info', 'WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω');
                };
                
                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    log('received', `–ü–æ–ª—É—á–µ–Ω–æ: ${JSON.stringify(data, null, 2)}`);
                };
                
                ws.onclose = function() {
                    isConnected = false;
                    updateWebSocketStatus('–û—Ç–∫–ª—é—á–µ–Ω', 'disconnected');
                    log('info', 'WebSocket –æ—Ç–∫–ª—é—á–µ–Ω');
                };
                
                ws.onerror = function(error) {
                    log('error', `WebSocket –æ—à–∏–±–∫–∞: ${error}`);
                };
                
            } catch (error) {
                log('error', `–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}`);
            }
        }

        function disconnectWebSocket() {
            if (ws) {
                ws.close();
                ws = null;
            }
        }

        function sendWebSocketMessage(action, data = {}) {
            if (!isConnected || !ws) {
                log('error', 'WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
                return;
            }
            
            const message = { action, data };
            ws.send(JSON.stringify(message));
            log('sent', `–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: ${JSON.stringify(message, null, 2)}`);
        }

        // WebSocket –¥–µ–π—Å—Ç–≤–∏—è
        function joinRoom() {
            const roomId = document.getElementById('joinRoomId').value;
            if (!roomId) {
                log('error', '–í–≤–µ–¥–∏—Ç–µ ID –∫–æ–º–Ω–∞—Ç—ã');
                return;
            }
            sendWebSocketMessage('join_room', { room_id: parseInt(roomId) });
        }

        function joinRoomByCode() {
            const roomCode = document.getElementById('joinRoomCode').value;
            if (!roomCode) {
                log('error', '–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã');
                return;
            }
            sendWebSocketMessage('join_room', { room_code: roomCode });
        }

        function leaveRoom() {
            sendWebSocketMessage('leave_room', {});
        }

        function startGame() {
            sendWebSocketMessage('start_game', {});
        }

        function startRound() {
            const situationText = document.getElementById('situationText').value;
            sendWebSocketMessage('start_round', { situation_text: situationText });
        }

        function getGameState() {
            const gameId = document.getElementById('gameId').value;
            if (!gameId) {
                log('error', '–í–≤–µ–¥–∏—Ç–µ ID –∏–≥—Ä—ã');
                return;
            }
            sendWebSocketMessage('get_game_state', { game_id: parseInt(gameId) });
        }

        function submitCardChoice() {
            const roundId = document.getElementById('roundId').value;
            const cardType = document.getElementById('cardType').value;
            const cardNumber = document.getElementById('cardNumber').value;
            
            if (!roundId || !cardType || !cardNumber) {
                log('error', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–∞—Ä—Ç—ã');
                return;
            }
            
            sendWebSocketMessage('submit_card_choice', {
                round_id: parseInt(roundId),
                card_type: cardType,
                card_number: parseInt(cardNumber)
            });
        }

        function submitVote() {
            const roundId = document.getElementById('voteRoundId').value;
            const cardId = document.getElementById('voteCardId').value;
            
            if (!roundId || !cardId) {
                log('error', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è');
                return;
            }
            
            sendWebSocketMessage('submit_vote', {
                round_id: parseInt(roundId),
                card_id: parseInt(cardId)
            });
        }

        function ping() {
            sendWebSocketMessage('ping', {});
        }

        function getRoundCards() {
            const roundId = document.getElementById('roundId').value;
            if (!roundId) {
                log('error', '–í–≤–µ–¥–∏—Ç–µ ID —Ä–∞—É–Ω–¥–∞');
                return;
            }
            sendWebSocketMessage('get_round_cards', { round_id: parseInt(roundId) });
        }

        function getChoicesForVoting() {
            const roundId = document.getElementById('voteRoundId').value;
            if (!roundId) {
                log('error', '–í–≤–µ–¥–∏—Ç–µ ID —Ä–∞—É–Ω–¥–∞');
                return;
            }
            sendWebSocketMessage('get_choices_for_voting', { round_id: parseInt(roundId) });
        }

        // HTTP API —Ñ—É–Ω–∫—Ü–∏–∏
        async function makeHttpRequest(method, endpoint, data = null) {
            const token = document.getElementById('httpToken').value;
            const headers = {
                'Content-Type': 'application/json'
            };
            
            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            }

            const options = {
                method,
                headers,
                body: data ? JSON.stringify(data) : null
            };

            try {
                const response = await fetch(`${API_BASE}${endpoint}`, options);
                const result = await response.json();
                
                if (response.ok) {
                    logHttp('success', `${method} ${endpoint}: ${JSON.stringify(result, null, 2)}`);
                } else {
                    logHttp('error', `${method} ${endpoint}: ${JSON.stringify(result, null, 2)}`);
                }
                
                return result;
            } catch (error) {
                logHttp('error', `–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ${method} ${endpoint}: ${error.message}`);
            }
        }

        // –ö–æ–º–Ω–∞—Ç—ã API
        function createRoom() {
            const data = {
                max_players: parseInt(document.getElementById('roomMaxPlayers').value),
                is_public: document.getElementById('roomIsPublic').value === 'true',
                age_group: document.getElementById('roomAgeGroup').value
            };
            makeHttpRequest('POST', '/rooms/', data);
        }

        function getPublicRooms() {
            makeHttpRequest('GET', '/rooms/public');
        }

        function getMyRooms() {
            makeHttpRequest('GET', '/rooms/my');
        }

        // –ò–≥—Ä—ã API
        function getGame() {
            const gameId = document.getElementById('httpGameId').value;
            if (!gameId) {
                logHttp('error', '–í–≤–µ–¥–∏—Ç–µ ID –∏–≥—Ä—ã');
                return;
            }
            makeHttpRequest('GET', `/games/${gameId}`);
        }

        function getCurrentGame() {
            const roomId = document.getElementById('httpRoomId').value;
            if (!roomId) {
                logHttp('error', '–í–≤–µ–¥–∏—Ç–µ ID –∫–æ–º–Ω–∞—Ç—ã');
                return;
            }
            makeHttpRequest('GET', `/games/rooms/${roomId}/current-game`);
        }

        function getMyCards() {
            const count = document.getElementById('cardsCount').value;
            makeHttpRequest('GET', `/games/my-cards-for-game?count=${count}`);
        }

        function generateSituation() {
            const data = {
                topic: "—Ä–∞–±–æ—Ç–∞",
                difficulty: "medium",
                age_group: "adult"
            };
            makeHttpRequest('POST', '/games/situations/generate', data);
        }

        // –ö–∞—Ä—Ç—ã API
        function getUserCards() {
            makeHttpRequest('GET', '/cards/my');
        }

        function getStarterCards() {
            makeHttpRequest('GET', '/cards/starter');
        }

        function getUniqueCards() {
            makeHttpRequest('GET', '/cards/unique');
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function updateWebSocketStatus(message, className) {
            const status = document.getElementById('wsStatus');
            status.innerHTML = `<strong>–°—Ç–∞—Ç—É—Å:</strong> ${message}`;
            status.className = `status ${className}`;
        }

        function log(type, message) {
            const log = document.getElementById('wsLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function logHttp(type, message) {
            const log = document.getElementById('httpLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function switchTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');
        }

        function switchHttpTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('#rooms-tab, #games-tab, #cards-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.section:last-child .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');
        }

        // –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
        function clearLogs() {
            document.getElementById('wsLog').innerHTML = '<div class="log-entry info">WebSocket –ª–æ–≥ –æ—á–∏—â–µ–Ω...</div>';
            document.getElementById('httpLog').innerHTML = '<div class="log-entry info">HTTP API –ª–æ–≥ –æ—á–∏—â–µ–Ω...</div>';
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤
        document.addEventListener('DOMContentLoaded', function() {
            const wsSection = document.querySelector('.section:first-child');
            const httpSection = document.querySelector('.section:last-child');
            
            const clearWsBtn = document.createElement('button');
            clearWsBtn.className = 'btn btn-warning';
            clearWsBtn.textContent = 'üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥';
            clearWsBtn.onclick = () => document.getElementById('wsLog').innerHTML = '<div class="log-entry info">WebSocket –ª–æ–≥ –æ—á–∏—â–µ–Ω...</div>';
            
            const clearHttpBtn = document.createElement('button');
            clearHttpBtn.className = 'btn btn-warning';
            clearHttpBtn.textContent = 'üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥';
            clearHttpBtn.onclick = () => document.getElementById('httpLog').innerHTML = '<div class="log-entry info">HTTP API –ª–æ–≥ –æ—á–∏—â–µ–Ω...</div>';
            
            wsSection.appendChild(clearWsBtn);
            httpSection.appendChild(clearHttpBtn);
        });
    </script>
</body>
</html> 